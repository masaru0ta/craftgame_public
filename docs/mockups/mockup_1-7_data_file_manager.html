<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† - ãƒ¢ãƒƒã‚¯</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; background: #f0f0f0; height: 100vh; display: flex; flex-direction: column; }

    /* ã‚¿ãƒ– */
    .tabs { display: flex; background: #333; }
    .tab { padding: 12px 24px; color: #aaa; cursor: pointer; border-bottom: 3px solid transparent; }
    .tab:hover { color: #fff; background: #444; }
    .tab.active { color: #fff; border-bottom-color: #4285f4; background: #444; }
    .tab.data-tab { border-right: 1px solid #555; }

    /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .main { flex: 1; display: none; overflow: hidden; }
    .main.active { display: flex; }
    .column { background: #fff; overflow-y: auto; padding: 16px; }
    .col-left { flex: 3; border-right: 1px solid #ddd; }
    .col-mid { flex: 2; border-right: 1px solid #ddd; }
    .col-right { flex: 5; background: #fafafa; }
    .col-7 { flex: 7; }
    .col-3 { flex: 3; }

    /* ãƒ‡ãƒ¼ã‚¿é¸æŠç”»é¢ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .col-data-left { flex: 4; border-right: 1px solid #ddd; }
    .col-data-right { flex: 6; background: #fafafa; padding: 24px; }

    /* ã‚¿ã‚¤ãƒ«ãƒ»ã‚°ãƒªãƒƒãƒ‰å…±é€š */
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(72px, 1fr)); gap: 8px; }
    .tile { padding: 8px; border: 2px solid transparent; border-radius: 6px; cursor: pointer; text-align: center; transition: all 0.15s; }
    .tile:hover { background: #f5f5f5; border-color: #ddd; }
    .tile.selected { background: #e3f2fd; border-color: #4285f4; }
    .tile.add-new { border: 2px dashed #aaa; }
    .tile.add-new:hover { border-color: #4285f4; background: #e8f0fe; }
    .tile-img { width: 48px; height: 48px; margin: 0 auto 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
    .tile-name { font-size: 11px; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .tile-id { font-size: 10px; color: #888; }

    /* ãƒ•ã‚©ãƒ¼ãƒ  */
    .form-group { margin-bottom: 12px; }
    .form-group label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; }
    .form-group .required { color: #d93025; }
    input, textarea, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
    input:focus, textarea:focus { outline: none; border-color: #4285f4; box-shadow: 0 0 0 2px rgba(66,133,244,0.2); }
    input[readonly] { background: #f5f5f5; color: #666; cursor: not-allowed; }
    .color-row { display: flex; gap: 8px; align-items: center; }
    .color-row input[type="color"] { width: 40px; height: 34px; padding: 2px; cursor: pointer; }
    .color-row input[type="text"] { flex: 1; }

    /* ãƒœã‚¿ãƒ³ */
    .btn-row { display: flex; gap: 8px; justify-content: flex-end; margin-top: 16px; padding-top: 16px; border-top: 1px solid #ddd; }
    .btn-row-between { justify-content: space-between; }
    button { padding: 8px 20px; border: none; border-radius: 4px; font-size: 14px; cursor: pointer; }
    .btn-primary { background: #4285f4; color: #fff; }
    .btn-primary:hover { background: #3367d6; }
    .btn-secondary { background: #fff; color: #666; border: 1px solid #ddd; }
    .btn-danger { background: #fff; color: #d93025; border: 1px solid #d93025; }

    /* 3Dãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ  */
    .preview-container { width: 100%; aspect-ratio: 3 / 4; background: #000; border-radius: 8px; display: flex; flex-direction: column; overflow: hidden; }
    .preview-toolbar { height: 12.5%; background: #1a1a1a; display: flex; align-items: center; padding: 0 8px; gap: 8px; }
    .preview-3d { flex: 1; display: flex; align-items: center; justify-content: center; color: #666; }
    .preview-control { height: 12.5%; background: #1a1a1a; display: flex; align-items: center; justify-content: center; padding: 0 8px; gap: 8px; }
    .toolbar-btn { width: 32px; height: 32px; background: #333; border: 1px solid #555; border-radius: 4px; color: #fff; cursor: pointer; font-size: 11px; }
    .toolbar-btn:hover { background: #444; }

    /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
    .preview-large { width: 100px; height: 100px; margin: 0 auto 16px; }

    /* ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ */
    .data-file-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .data-file-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border: 2px solid #eee;
      border-radius: 8px;
      background: #fff;
      cursor: pointer;
      transition: all 0.15s;
    }
    .data-file-item:hover { border-color: #ccc; background: #fafafa; }
    .data-file-item.selected {
      border-color: #4285f4;
      background: #e3f2fd;
    }
    .data-file-icon {
      width: 44px;
      height: 44px;
      background: #e8f5e9;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      flex-shrink: 0;
    }
    .data-file-item.selected .data-file-icon {
      background: #c8e6c9;
    }
    .data-file-info {
      flex: 1;
      min-width: 0;
    }
    .data-file-name {
      font-weight: 500;
      font-size: 14px;
      color: #333;
      margin-bottom: 2px;
    }
    .data-file-spreadsheet-id {
      font-size: 11px;
      color: #888;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .data-file-meta {
      font-size: 10px;
      color: #aaa;
      margin-top: 2px;
    }
    .data-file-status {
      padding: 4px 8px;
      background: #4285f4;
      color: #fff;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
    }

    /* è¿½åŠ ãƒœã‚¿ãƒ³ */
    .add-file-item {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 16px;
      border: 2px dashed #aaa;
      border-radius: 8px;
      background: transparent;
      color: #666;
      cursor: pointer;
      transition: all 0.15s;
    }
    .add-file-item:hover {
      border-color: #4285f4;
      color: #4285f4;
      background: #f8f9ff;
    }

    /* è©³ç´°ãƒ‘ãƒãƒ« */
    .detail-panel {
      max-width: 500px;
    }
    .detail-panel h3 {
      font-size: 18px;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #4285f4;
    }
    .detail-panel .form-group {
      margin-bottom: 16px;
    }
    .detail-panel .form-group label {
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 6px;
    }
    .detail-panel input {
      padding: 10px 12px;
    }

    /* æ³¨æ„æ›¸ã */
    .notice {
      padding: 12px 16px;
      background: #fff3e0;
      border-radius: 6px;
      font-size: 12px;
      color: #e65100;
      margin-top: 20px;
    }
    .notice strong { display: block; margin-bottom: 4px; }

    /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
    .error-message {
      color: #d93025;
      font-size: 12px;
      margin-top: 4px;
      display: none;
    }
    .error-message.show { display: block; }

    /* ç©ºçŠ¶æ…‹ */
    .empty-detail {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 300px;
      color: #999;
    }
    .empty-detail .icon {
      font-size: 48px;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <div class="tabs">
    <div class="tab data-tab active" onclick="switchTab('data')">ãƒ‡ãƒ¼ã‚¿é¸æŠ</div>
    <div class="tab" onclick="switchTab('blocks')">ãƒ–ãƒ­ãƒƒã‚¯ä¸€è¦§</div>
    <div class="tab" onclick="switchTab('textures')">ãƒ†ã‚¯ã‚¹ãƒãƒ£ä¸€è¦§</div>
  </div>

  <!-- ãƒ‡ãƒ¼ã‚¿é¸æŠ -->
  <div class="main active" id="dataSelect">
    <div class="column col-data-left">
      <h3 style="margin-bottom:16px;">ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§</h3>
      <div class="data-file-list">
        <div class="data-file-item selected" onclick="selectDataFile(this, 0)">
          <div class="data-file-icon">ğŸ“Š</div>
          <div class="data-file-info">
            <div class="data-file-name">default_data</div>
            <div class="data-file-spreadsheet-id">1opkXxb8BRxQKGD7WKwbEvElWfd9UvIvx8wIDdm36GiM</div>
            <div class="data-file-meta">ä½œæˆ: 2024/01/10</div>
          </div>
          <div class="data-file-status">ä½¿ç”¨ä¸­</div>
        </div>
        <div class="data-file-item" onclick="selectDataFile(this, 1)">
          <div class="data-file-icon">ğŸ“Š</div>
          <div class="data-file-info">
            <div class="data-file-name">test_data</div>
            <div class="data-file-spreadsheet-id">1abc123def456ghi789jkl012mno345pqr678stu901vwx</div>
            <div class="data-file-meta">ä½œæˆ: 2024/01/12</div>
          </div>
        </div>
        <div class="data-file-item" onclick="selectDataFile(this, 2)">
          <div class="data-file-icon">ğŸ“Š</div>
          <div class="data-file-info">
            <div class="data-file-name">backup_20240115</div>
            <div class="data-file-spreadsheet-id">1xyz987wvu654tsr321qpo098nml765kji432hgf210edc</div>
            <div class="data-file-meta">ä½œæˆ: 2024/01/15</div>
          </div>
        </div>
        <div class="add-file-item" onclick="showAddMode()">
          <span style="font-size:20px;">+</span>
          <span>æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ </span>
        </div>
      </div>
    </div>
    <div class="column col-data-right">
      <!-- è©³ç´°è¡¨ç¤ºï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰ -->
      <div class="detail-panel" id="detailPanel">
        <h3 id="detailTitle">ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°</h3>
        <div class="form-group">
          <label>ãƒ•ã‚¡ã‚¤ãƒ«å<span class="required">*</span></label>
          <input type="text" id="detailName" value="default_data">
          <div class="error-message" id="nameError">ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
        </div>
        <div class="form-group">
          <label>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID<span class="required">*</span></label>
          <input type="text" id="detailSpreadsheetId" value="1opkXxb8BRxQKGD7WKwbEvElWfd9UvIvx8wIDdm36GiM">
          <div class="error-message" id="idError">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
        </div>
        <div class="form-group">
          <label>ä½œæˆæ—¥æ™‚</label>
          <input type="text" id="detailCreatedAt" value="2024/01/10 12:34:56" readonly>
        </div>
        <div class="btn-row btn-row-between">
          <button class="btn-danger" id="deleteBtn" onclick="deleteFile()">å‰Šé™¤</button>
          <div style="display:flex;gap:8px;">
            <button class="btn-secondary" id="copyBtn" onclick="copyFile()">ã‚³ãƒ”ãƒ¼ä½œæˆ</button>
            <button class="btn-primary" id="useBtn" onclick="useFile()">ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨</button>
            <button class="btn-secondary" id="saveBtn" onclick="saveFile()">ä¿å­˜</button>
          </div>
        </div>
        <div class="notice">
          <strong>æ³¨æ„</strong>
          ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã¯1-1ã§å®šç¾©ã•ã‚ŒãŸã‚·ãƒ¼ãƒˆæ§‹é€ ï¼ˆãƒ–ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã€ãƒ†ã‚¯ã‚¹ãƒãƒ£ï¼‰ãŒå¿…è¦ã§ã™ã€‚
          ã¾ãŸã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
        </div>
      </div>

      <!-- æ–°è¦è¿½åŠ ãƒ¢ãƒ¼ãƒ‰ -->
      <div class="detail-panel" id="addPanel" style="display:none;">
        <h3>æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ </h3>
        <div class="form-group">
          <label>ãƒ•ã‚¡ã‚¤ãƒ«å<span class="required">*</span></label>
          <input type="text" id="newName" placeholder="ä¾‹: my_data">
          <div class="error-message" id="newNameError">ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
        </div>
        <div class="form-group">
          <label>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID<span class="required">*</span></label>
          <input type="text" id="newSpreadsheetId" placeholder="ä¾‹: 1opkXxb8BRxQKGD7WKwbEvElWfd9UvIvx8wIDdm36GiM">
          <div class="error-message" id="newIdError">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
        </div>
        <div class="btn-row">
          <button class="btn-secondary" onclick="cancelAdd()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-primary" onclick="confirmAdd()">è¿½åŠ </button>
        </div>
        <div class="notice">
          <strong>æ³¨æ„</strong>
          ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã¯1-1ã§å®šç¾©ã•ã‚ŒãŸã‚·ãƒ¼ãƒˆæ§‹é€ ï¼ˆãƒ–ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã€ãƒ†ã‚¯ã‚¹ãƒãƒ£ï¼‰ãŒå¿…è¦ã§ã™ã€‚
          ã¾ãŸã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒ–ãƒ­ãƒƒã‚¯ä¸€è¦§ -->
  <div class="main" id="blockList">
    <div class="column col-left">
      <div class="grid">
        <div class="tile selected"><div class="tile-img" style="background:#9e9e9e;"></div><div class="tile-name">çŸ³</div></div>
        <div class="tile"><div class="tile-img" style="background:#8d6e63;"></div><div class="tile-name">åœŸ</div></div>
        <div class="tile"><div class="tile-img" style="background:#81c784;"></div><div class="tile-name">è‰ãƒ–ãƒ­ãƒƒã‚¯</div></div>
        <div class="tile"><div class="tile-img" style="background:#795548;"></div><div class="tile-name">ã‚ªãƒ¼ã‚¯ã®åŸæœ¨</div></div>
        <div class="tile"><div class="tile-img" style="background:#c62828;"></div><div class="tile-name">ãƒ¬ãƒ³ã‚¬</div></div>
        <div class="tile"><div class="tile-img" style="background:#78909c;"></div><div class="tile-name">ä¸¸çŸ³</div></div>
        <div class="tile add-new"><div class="tile-img" style="font-size:24px;color:#4285f4;">+</div><div class="tile-name">æ–°è¦è¿½åŠ </div></div>
      </div>
    </div>
    <div class="column col-mid">
      <h3 style="margin-bottom:16px;">åŸºæœ¬æƒ…å ±</h3>
      <div class="form-group"><label>ãƒ–ãƒ­ãƒƒã‚¯ID<span class="required">*</span></label><input type="text" value="stone"></div>
      <div class="form-group"><label>è¡¨ç¤ºå<span class="required">*</span></label><input type="text" value="çŸ³"></div>
      <div class="form-group">
        <label>ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ—</label>
        <select>
          <option value="normal" selected>é€šå¸¸ãƒ–ãƒ­ãƒƒã‚¯</option>
          <option value="custom">ã‚«ã‚¹ã‚¿ãƒ ãƒ–ãƒ­ãƒƒã‚¯</option>
        </select>
      </div>
      <div class="form-group"><label>ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¤ãƒ†ãƒ </label><input type="text" value="cobblestone"></div>
      <div class="form-group"><label>ç™ºå…‰ãƒ¬ãƒ™ãƒ« (0-15)</label><input type="number" min="0" max="15" value="0"></div>
      <div class="btn-row"><button class="btn-danger">å‰Šé™¤</button><button class="btn-primary">ä¿å­˜</button></div>
    </div>
    <div class="column col-right">
      <div class="preview-container">
        <div class="preview-toolbar">
          <div style="flex:1;"></div>
          <button class="toolbar-btn" title="èƒŒæ™¯è‰²åˆ‡ã‚Šæ›¿ãˆ">BG</button>
        </div>
        <div class="preview-3d">
          <span>ï¼ˆ3Dãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰</span>
        </div>
        <div class="preview-control">
          <div class="material-item" style="display:inline-block;"><div class="preview" style="background:#9e9e9e;width:32px;height:32px;border-radius:4px;"></div><div style="color:#888;font-size:9px;">default</div></div>
          <div class="material-item" style="display:inline-block;"><div class="preview" style="background:#9e9e9e;width:32px;height:32px;border-radius:4px;"></div><div style="color:#888;font-size:9px;">top</div></div>
          <div class="material-item" style="display:inline-block;"><div class="preview" style="background:#9e9e9e;width:32px;height:32px;border-radius:4px;"></div><div style="color:#888;font-size:9px;">bottom</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒ†ã‚¯ã‚¹ãƒãƒ£ä¸€è¦§ -->
  <div class="main" id="textureList">
    <div class="column col-7">
      <h3 style="margin-bottom:16px;">ãƒ†ã‚¯ã‚¹ãƒãƒ£ä¸€è¦§</h3>
      <div class="grid">
        <div class="tile selected"><div class="tile-img" style="background:#9e9e9e;"></div><div class="tile-id">ID: 0</div><div class="tile-name">stone.png</div></div>
        <div class="tile"><div class="tile-img" style="background:#8d6e63;"></div><div class="tile-id">ID: 1</div><div class="tile-name">dirt.png</div></div>
        <div class="tile"><div class="tile-img" style="background:#81c784;"></div><div class="tile-id">ID: 2</div><div class="tile-name">grass_top.png</div></div>
      </div>
    </div>
    <div class="column col-3">
      <h3 style="margin-bottom:16px;">ãƒ†ã‚¯ã‚¹ãƒãƒ£è©³ç´°</h3>
      <div class="preview-large" style="background:#9e9e9e;border-radius:8px;"></div>
      <div class="form-group"><label>ãƒ†ã‚¯ã‚¹ãƒãƒ£ID</label><input type="number" value="0" readonly></div>
      <div class="form-group"><label>ãƒ•ã‚¡ã‚¤ãƒ«å</label><input type="text" value="stone.png" readonly></div>
      <div class="form-group">
        <label>ä»£è¡¨è‰²ï¼ˆãƒãƒƒãƒ—è¡¨ç¤ºç”¨ï¼‰</label>
        <div class="color-row"><input type="color" value="#9e9e9e"><input type="text" value="#9e9e9e"></div>
      </div>
      <div class="btn-row btn-row-between"><button class="btn-danger">å‰Šé™¤</button><button class="btn-primary">ä¿å­˜</button></div>
    </div>
  </div>

  <script>
    // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
    const dataFiles = [
      { name: 'default_data', spreadsheetId: '1opkXxb8BRxQKGD7WKwbEvElWfd9UvIvx8wIDdm36GiM', createdAt: '2024/01/10 12:34:56' },
      { name: 'test_data', spreadsheetId: '1abc123def456ghi789jkl012mno345pqr678stu901vwx', createdAt: '2024/01/12 09:15:30' },
      { name: 'backup_20240115', spreadsheetId: '1xyz987wvu654tsr321qpo098nml765kji432hgf210edc', createdAt: '2024/01/15 18:22:45' }
    ];
    let selectedIndex = 0;
    let activeFileIndex = 0; // ä½¿ç”¨ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«

    function switchTab(tab) {
      document.querySelectorAll('.tab').forEach((t, i) => {
        if (tab === 'data') t.classList.toggle('active', i === 0);
        else if (tab === 'blocks') t.classList.toggle('active', i === 1);
        else t.classList.toggle('active', i === 2);
      });
      document.getElementById('dataSelect').classList.toggle('active', tab === 'data');
      document.getElementById('blockList').classList.toggle('active', tab === 'blocks');
      document.getElementById('textureList').classList.toggle('active', tab === 'textures');
    }

    function selectDataFile(el, index) {
      selectedIndex = index;
      document.querySelectorAll('.data-file-item').forEach(item => item.classList.remove('selected'));
      el.classList.add('selected');

      // è©³ç´°ãƒ‘ãƒãƒ«æ›´æ–°
      document.getElementById('addPanel').style.display = 'none';
      document.getElementById('detailPanel').style.display = 'block';
      document.getElementById('detailTitle').textContent = 'ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°';
      document.getElementById('detailName').value = dataFiles[index].name;
      document.getElementById('detailSpreadsheetId').value = dataFiles[index].spreadsheetId;
      document.getElementById('detailCreatedAt').value = dataFiles[index].createdAt;

      // ä½¿ç”¨ä¸­ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹
      document.getElementById('useBtn').style.display = index === activeFileIndex ? 'none' : 'inline-block';
      document.getElementById('deleteBtn').disabled = index === activeFileIndex;
      document.getElementById('deleteBtn').style.opacity = index === activeFileIndex ? '0.5' : '1';
    }

    function showAddMode() {
      document.querySelectorAll('.data-file-item').forEach(item => item.classList.remove('selected'));
      document.getElementById('detailPanel').style.display = 'none';
      document.getElementById('addPanel').style.display = 'block';
      document.getElementById('newName').value = '';
      document.getElementById('newSpreadsheetId').value = '';
      document.getElementById('newName').focus();
    }

    function cancelAdd() {
      document.getElementById('addPanel').style.display = 'none';
      document.getElementById('detailPanel').style.display = 'block';
      // æœ€åˆã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’é¸æŠ
      const firstItem = document.querySelector('.data-file-item');
      if (firstItem) {
        selectDataFile(firstItem, 0);
      }
    }

    function confirmAdd() {
      const name = document.getElementById('newName').value.trim();
      const spreadsheetId = document.getElementById('newSpreadsheetId').value.trim();
      let valid = true;

      if (!name) {
        document.getElementById('newNameError').classList.add('show');
        valid = false;
      } else {
        document.getElementById('newNameError').classList.remove('show');
      }

      if (!spreadsheetId) {
        document.getElementById('newIdError').classList.add('show');
        valid = false;
      } else {
        document.getElementById('newIdError').classList.remove('show');
      }

      if (valid) {
        alert('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ' + name + 'ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼ˆãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰');
        cancelAdd();
      }
    }

    function copyFile() {
      const original = dataFiles[selectedIndex];
      const newName = original.name + '_copy';
      alert('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ' + newName + 'ã€ã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰\nâ€»å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚‚åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™');
    }

    function useFile() {
      const name = dataFiles[selectedIndex].name;
      if (confirm('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ' + name + 'ã€ã‚’ä½¿ç”¨ã—ã¾ã™ã‹ï¼Ÿ\nâ€»ãƒ–ãƒ­ãƒƒã‚¯ä¸€è¦§ãƒ»ãƒ†ã‚¯ã‚¹ãƒãƒ£ä¸€è¦§ã®ãƒ‡ãƒ¼ã‚¿ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™')) {
        // å‰ã®ä½¿ç”¨ä¸­è¡¨ç¤ºã‚’å‰Šé™¤
        document.querySelectorAll('.data-file-status').forEach(el => el.remove());
        // æ–°ã—ã„ä½¿ç”¨ä¸­è¡¨ç¤ºã‚’è¿½åŠ 
        activeFileIndex = selectedIndex;
        const selectedItem = document.querySelector('.data-file-item.selected');
        const status = document.createElement('div');
        status.className = 'data-file-status';
        status.textContent = 'ä½¿ç”¨ä¸­';
        selectedItem.appendChild(status);
        // ãƒœã‚¿ãƒ³æ›´æ–°
        document.getElementById('useBtn').style.display = 'none';
        document.getElementById('deleteBtn').disabled = true;
        document.getElementById('deleteBtn').style.opacity = '0.5';

        alert('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸï¼ˆãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰');
      }
    }

    function saveFile() {
      const name = document.getElementById('detailName').value.trim();
      const spreadsheetId = document.getElementById('detailSpreadsheetId').value.trim();
      let valid = true;

      if (!name) {
        document.getElementById('nameError').classList.add('show');
        valid = false;
      } else {
        document.getElementById('nameError').classList.remove('show');
      }

      if (!spreadsheetId) {
        document.getElementById('idError').classList.add('show');
        valid = false;
      } else {
        document.getElementById('idError').classList.remove('show');
      }

      if (valid) {
        dataFiles[selectedIndex].name = name;
        dataFiles[selectedIndex].spreadsheetId = spreadsheetId;
        // ãƒªã‚¹ãƒˆè¡¨ç¤ºã‚’æ›´æ–°
        const selectedItem = document.querySelector('.data-file-item.selected');
        selectedItem.querySelector('.data-file-name').textContent = name;
        selectedItem.querySelector('.data-file-spreadsheet-id').textContent = spreadsheetId;
        alert('ä¿å­˜ã—ã¾ã—ãŸï¼ˆãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰');
      }
    }

    function deleteFile() {
      if (selectedIndex === activeFileIndex) {
        alert('ä½¿ç”¨ä¸­ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã§ãã¾ã›ã‚“');
        return;
      }
      const name = dataFiles[selectedIndex].name;
      if (confirm('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ' + name + 'ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
        document.querySelector('.data-file-item.selected').remove();
        dataFiles.splice(selectedIndex, 1);
        // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹èª¿æ•´
        if (activeFileIndex > selectedIndex) activeFileIndex--;
        selectedIndex = 0;
        // æœ€åˆã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’é¸æŠ
        const firstItem = document.querySelector('.data-file-item');
        if (firstItem) {
          selectDataFile(firstItem, 0);
        }
      }
    }
  </script>
</body>
</html>
